# Story 1.6: registro-de-ferramentas-adk

## Status
Draft

## Story
**Como** desenvolvedor,\
**Quero** registrar os agentes `whisper_agent`, `create_agent` e `update_agent` como ferramentas (`tools`) disponíveis para o `aido_orchestrator` no ADK,\
**Para que** o orquestrador possa invocá-los dinamicamente durante os fluxos.

## Acceptance Criteria
1. Os três agentes são registrados como ferramentas ADK no orquestrador, com contratos de entrada/saída documentados. [Fonte: architecture/padroes-inovadores.md#loop-de-sintese-de-manuais; architecture/mapeamento-de-epicos-para-arquitetura.md#mapeamento-de-epicos-para-arquitetura]
2. O orquestrador resolve dinamicamente as ferramentas a partir de `packages/agents/` usando configuração centralizada. [Fonte: architecture/estrutura-de-projeto.md#estrutura-de-projeto; architecture/resumo-das-decisoes.md#resumo-das-decisoes]
3. Cada ferramenta publica eventos de progresso padronizados e responde com payloads consistentes. [Fonte: architecture/padroes-de-implementacao-anti-conflito.md#padroes-de-implementacao-anti-conflito]
4. Os testes de integração validam o registro e a invocação sequencial através do WorkflowAgent. [Fonte: architecture/detalhes-da-pilha-tecnologica.md#tecnologias-centrais]

## Tasks / Subtasks
- [ ] Criar registros das ferramentas no orquestrador (`packages/orchestrator/app/workflows/registry.py` ou equivalente). [Fonte: architecture/estrutura-de-projeto.md#estrutura-de-projeto]
- [ ] Definir schemas de entrada/saída (pydantic) para cada ferramenta. [Fonte: architecture/padroes-de-implementacao-anti-conflito.md#padroes-de-implementacao-anti-conflito]
- [ ] Garantir injeção de dependências (serviços, repositórios) necessária para cada agente. [Fonte: architecture/resumo-das-decisoes.md#resumo-das-decisoes]
- [ ] Atualizar WorkflowAgent para resolver ferramentas por identificador (`whisper`, `create`, `update`). [Fonte: architecture/padroes-inovadores.md#loop-de-sintese-de-manuais]
- [ ] Criar testes integrados em `tests/integration/workflows/test_tool_registry.py`. [Fonte: architecture/detalhes-da-pilha-tecnologica.md#tecnologias-centrais]
- [ ] Documentar contratos e IDs das ferramentas no README técnico. [Fonte: architecture/padroes-de-implementacao-anti-conflito.md#padroes-de-implementacao-anti-conflito]

## Dev Notes
### Previous Story Insights
Histórias 1.2, 1.3, 1.4 e 1.5 fornecem as implementações dos agentes; esta história conecta tudo ao orquestrador. [Fonte: docs/stories/1.2.aido-orchestrator-workflow-agent.md; docs/stories/1.3.whisper-agent-sequential.md; docs/stories/1.4.create-agent-loop.md; docs/stories/1.5.update-agent-loop.md]

### Data Models
- Sem novas tabelas; reutiliza `sessions`, `events`, `manual_versions` e `transcripts` via ferramentas registradas. [Fonte: architecture/arquitetura-de-dados.md#modelo-relacional]

### API Specifications
- Invocações partem dos endpoints `/api/projects/{id}/messages` e SSE `/api/projects/{id}/stream`, disparando as ferramentas conforme instruções. [Fonte: architecture/contratos-de-api.md#contratos-de-api]

### Component Specifications
- Registro central em `packages/orchestrator/app/workflows/` com carregamento modular. [Fonte: architecture/estrutura-de-projeto.md#estrutura-de-projeto]
- Utilização de identificadores consistentes e mapeamento para classes dos agentes. [Fonte: architecture/padroes-de-implementacao-anti-conflito.md#padroes-de-implementacao-anti-conflito]

### File Locations
- Registry/Factory do orquestrador: `packages/orchestrator/app/workflows/tool_registry.py` (ou similar). [Fonte: architecture/estrutura-de-projeto.md#estrutura-de-projeto]
- Definições das ferramentas nos respectivos diretórios dos agentes. [Fonte: architecture/estrutura-de-projeto.md#estrutura-de-projeto]

### Testing
- Testes integrados simulando chamadas do WorkflowAgent e verificando eventos/payloads. [Fonte: architecture/detalhes-da-pilha-tecnologica.md#tecnologias-centrais]
- Cobrir cenários de falha (ferramenta não encontrada, erro do agente) com logs e exceções padronizadas. [Fonte: architecture/regras-de-consistencia.md#regras-de-consistencia]

### Technical Constraints
- Manter execução local, sem dependências externas além das definidas (ADK, docxtpl, whisper). [Fonte: architecture/detalhes-da-pilha-tecnologica.md#tecnologias-centrais]
- Garantir que configurações e secrets fiquem no `.env` protegido. [Fonte: architecture/arquitetura-de-seguranca.md#arquitetura-de-seguranca]

## Change Log
| Date | Version | Description | Author |
|---|---|---|---|
| 2025-10-31 | 1.0 | Rascunho inicial | Bob (Scrum Master) |

## Dev Agent Record
### Agent Model Used

### Debug Log References

### Completion Notes List

### File List

## QA Results

